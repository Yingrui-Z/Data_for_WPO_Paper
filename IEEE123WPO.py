import numpy as np


class case123new():
    ###############################################################################################
    # Author: Lucien Bobo
    #
    # When publishing results based on this data, please cite:
    #
    # L. Bobo, A. Venzke, S. Chatzivasileiadis, "Second-Order Cone Relaxations
    # of the Optimal Power Flow for Active Distribution Grids", 2020. Available
    # online: https://arxiv.org/abs/2001.00898
    #
    # W. H. Kersting, Radial distribution test feeders, in Conference
    # Proceedings of the 2001 IEEE Power Engineering Society Winter Meeting,
    # 2001. vol. 2, pp. 908–912
    #################################################################################################

    # Feeder based on IEEE123 with the following simplifications:
    # - Regulator considered separately in mpc table regs with fixed voltage gains
    # - Root node regulator ignored two regulators shifted to downstream end of the line for simplicity
    # - Breakers replaced by short-circuits or open circuits (intermediate buses removed)
    # - Transformer ignored as lower-voltage side bus is with no load
    # - Substation transformer omitted (LV-side perspective)
    # - Spot load are distributed equally on three phases
    # - (11) element is used for 3-phase lines non-zero element is used for 1-phase lines
    # - Capacitors considered separately in mpc table caps
    # - Two buses relabelled



    def __init__(self):
        ## MATPOWER Case Format : Version 2
        self.version = 2

        self.network_type = "Distribution Network"

        ##-----  Power Flow Data  -----##
        ## system MVA base
        self.baseMVA = 1.0


        ## bus data
        #	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
        self.bus = np.array([
            [1, 3, 0.00, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.0, 1.0],
            [2, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [3, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [4, 1, 0.00, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [5, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [6, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [7, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [8, 1, 0.03, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [9, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [10, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [11, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [12, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [13, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [14, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [15, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [16, 1, 0.00, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [17, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [18, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [19, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [20, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [21, 1, 0.03, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [22, 1, 0.00, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [23, 1, 0.03, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [24, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [25, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [26, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [27, 1, 0.04, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [28, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [29, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [30, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [31, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [32, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [33, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [34, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [35, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [36, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [37, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [38, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [39, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [40, 1, 0.02, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [41, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [42, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [43, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [44, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [45, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [46, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [47, 1, 0.025, 0.025, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [48, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [49, 1, 0.04, 0.035, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [50, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [51, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [52, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [53, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [54, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [55, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [56, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [57, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [58, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [59, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [60, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [61, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [62, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [63, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [64, 1, 0.025, 0.015, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [65, 1, 0.04, 0.04, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [66, 1, 0.025, 0.015, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [67, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [68, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [69, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [70, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [71, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [72, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [73, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [74, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [75, 1, 0.01, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [76, 1, 0.045, 0.08, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [77, 1, 0.00, 0.00, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [78, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [79, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [80, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [81, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [82, 1, 0.02, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [83, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [84, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [85, 1, 0.02, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [86, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [87, 1, 0.02, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [88, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [89, 1, 0.06, 0.04, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [90, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [91, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [92, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [93, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [94, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [95, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [96, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [97, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [98, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [99, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [100, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [101, 1, 0.04, 0.03, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [102, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [103, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [104, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [105, 1, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [106, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [107, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [108, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [109, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [110, 1, 0.03, 0.03, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [111, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [112, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [113, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [114, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            #new added buses 
            [115, 1, 0.04, 0.03, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [116, 1, 0.04, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [117, 1, 0.02, 0.04, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [118, 1, 0.03, 0.05, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            #new added buses between existing buses
            [119, 1, 0.04, 0.06, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [120, 1, 0.02, 0.03, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [121, 1, 0.03, 0.02, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [122, 1, 0.02, 0.01, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
            [123, 1, 0.04, 0.04, 0.0, 0.0, 1.0, 1.0, 0.0, 4.16, 1.0, 1.2, 0.8],
        ])

        # #	# capacitor data
        # # bus total cap (sum over three phases) [MVAr]
        # self.caps = [
        #     [83,0.600],
        #     [88,0.050],
        #     [90,0.050],
        #     [92,0.050],
        #     ]
        #
        # #	# voltage regulator data
        # # bus ratio
        # self.regs = [
        #     [9,1.0],
        #     [26,1.0],
        #     [67,1.0],
        #     ]
        # # 9   0.99 	# RG2
        # # 26  1 	# RG3
        # # 67  1.05 	# RG4




        ## generator data
        #	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
        self.gen = np.array([
            [1, 0.0, 0.0, 2000.0, -2000.0, 1.0, 1.0, 1.0, 2000.0, -2000.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        ])

        ## branch data
        #	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
        self.branch = np.array([
            [1, 2, 0.002545703, 0.002580752, 0.00000259216, 0, 0, 0, 0, 0, 1, -360, 360],
            [2, 3, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [3, 4, 0.001502404, 0.003539317, 0.00000558155, 0, 0, 0, 0, 0, 1, -360, 360],
            [3, 5, 0.002909375, 0.002949431, 0.00000296247, 0, 0, 0, 0, 0, 1, -360, 360],
            [5, 6, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [5, 7, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [7, 8, 0.001001603, 0.002359545, 0.00000372103, 0, 0, 0, 0, 0, 1, -360, 360],
            # 头几个小支路
            [3, 9, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [9, 10, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [10, 11, 0.001502404, 0.003539317, 0.00000558155, 0, 0, 0, 0, 0, 1, -360, 360],
            [11, 12, 0.006182422, 0.006267540, 0.00000629525, 0, 0, 0, 0, 0, 1, -360, 360],
            [12, 13, 0.002182031, 0.002212073, 0.00000222185, 0, 0, 0, 0, 0, 1, -360, 360],
            [12, 14, 0.004212870, 0.009464061, 0.00001617235, 0, 0, 0, 0, 0, 1, -360, 360],
            [10, 15, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            # 支路1
            [15, 20, 0.005455079, 0.005530182, 0.00000555463, 0, 0, 0, 0, 0, 1, -360, 360],
            [20, 21, 0.005091407, 0.005161504, 0.00000518432, 0, 0, 0, 0, 0, 1, -360, 360],
            [21, 22, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [20, 23, 0.001531953, 0.003441477, 0.00000588086, 0, 0, 0, 0, 0, 1, -360, 360],
            [23, 24, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [23, 25, 0.007637110, 0.007742255, 0.00000777648, 0, 0, 0, 0, 0, 1, -360, 360],
            [25, 26, 0.001276627, 0.002867897, 0.00000490071, 0, 0, 0, 0, 0, 1, -360, 360],
            [25, 27, 0.008000782, 0.008110934, 0.00000814679, 0, 0, 0, 0, 0, 1, -360, 360],
            [27, 28, 0.001404290, 0.003154687, 0.00000539078, 0, 0, 0, 0, 0, 1, -360, 360],
            [28, 29, 0.001752804, 0.004129203, 0.00000586814, 0, 0, 0, 0, 0, 1, -360, 360],
            [29, 30, 0.001021302, 0.002294318, 0.00000392057, 0, 0, 0, 0, 0, 1, -360, 360],
            [30, 31, 0.001377204, 0.003244374, 0.00000461068, 0, 0, 0, 0, 0, 1, -360, 360],
            [27, 32, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [32, 33, 0.007273438, 0.007373577, 0.00000740617, 0, 0, 0, 0, 0, 1, -360, 360],
            [33, 34, 0.001531953, 0.003441477, 0.00000588086, 0, 0, 0, 0, 0, 1, -360, 360],
            [32, 35, 0.001787278, 0.004015056, 0.00000686100, 0, 0, 0, 0, 0, 1, -360, 360],
            [35, 36, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            # 支路2
            [15, 37, 0.001454688, 0.001474715, 0.00000148123, 0, 0, 0, 0, 0, 1, -360, 360],
            [37, 38, 0.003255208, 0.007668520, 0.00001089797, 0, 0, 0, 0, 0, 1, -360, 360],
            [38, 39, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [37, 40, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
            [37, 41, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            [41, 42, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [41, 43, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [43, 44, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [43, 45, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
            [45, 46, 0.007273438, 0.007373577, 0.00000740617, 0, 0, 0, 0, 0, 1, -360, 360],
            [46, 47, 0.001001603, 0.002359545, 0.00000372103, 0, 0, 0, 0, 0, 1, -360, 360],
            [45, 48, 0.002909375, 0.002949431, 0.00000296247, 0, 0, 0, 0, 0, 1, -360, 360],
            [48, 49, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
            [48, 50, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            [50, 51, 0.000757604, 0.001748482, 0.00000265341, 0, 0, 0, 0, 0, 1, -360, 360],
            [51, 52, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            [52, 53, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            # 支路3
            [15, 89, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            [89, 90, 0.001001603, 0.002359545, 0.00000372103, 0, 0, 0, 0, 0, 1, -360, 360],
            [90, 91, 0.000626002, 0.001474715, 0.00000232564, 0, 0, 0, 0, 0, 1, -360, 360],
            [91, 92, 0.001377204, 0.003244374, 0.00000511642, 0, 0, 0, 0, 0, 1, -360, 360],
            [92, 93, 0.001767743, 0.004079790, 0.00000619129, 0, 0, 0, 0, 0, 1, -360, 360],
            [93, 94, 0.001377204, 0.003244374, 0.00000511642, 0, 0, 0, 0, 0, 1, -360, 360],
            [92, 95, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [95, 96, 0.003788021, 0.008742408, 0.00001326705, 0, 0, 0, 0, 0, 1, -360, 360],
            [96, 97, 0.003636719, 0.003686788, 0.00000370309, 0, 0, 0, 0, 0, 1, -360, 360],
            [95, 98, 0.004161214, 0.002057761, 0.00005508310, 0, 0, 0, 0, 0, 1, -360, 360],
            [98, 99, 0.002912850, 0.001440433, 0.00003855817, 0, 0, 0, 0, 0, 1, -360, 360],
            [99, 100, 0.005825700, 0.002880866, 0.00007711634, 0, 0, 0, 0, 0, 1, -360, 360],
            [99, 101, 0.007074064, 0.003498194, 0.00009364127, 0, 0, 0, 0, 0, 1, -360, 360],
            [101, 102, 0.005409579, 0.002675090, 0.00007160803, 0, 0, 0, 0, 0, 1, -360, 360],
            [102, 103, 0.002909375, 0.002949431, 0.00000296247, 0, 0, 0, 0, 0, 1, -360, 360],
            [103, 104, 0.001388941, 0.003205550, 0.00000486459, 0, 0, 0, 0, 0, 1, -360, 360],
            [104, 105, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            [105, 106, 0.004000391, 0.004055467, 0.00000407340, 0, 0, 0, 0, 0, 1, -360, 360],
            [106, 107, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [104, 108, 0.004000391, 0.004055467, 0.00000407340, 0, 0, 0, 0, 0, 1, -360, 360],
            [108, 109, 0.004000391, 0.004055467, 0.00000407340, 0, 0, 0, 0, 0, 1, -360, 360],
            [108, 110, 0.001010139, 0.002331309, 0.00000353788, 0, 0, 0, 0, 0, 1, -360, 360],
            [110, 111, 0.005091407, 0.005161504, 0.00000518432, 0, 0, 0, 0, 0, 1, -360, 360],
            [108, 112, 0.005818751, 0.005898861, 0.00000592494, 0, 0, 0, 0, 0, 1, -360, 360],
            [112, 113, 0.002003205, 0.004719089, 0.00000744206, 0, 0, 0, 0, 0, 1, -360, 360],
            [113, 114, 0.003535486, 0.008159581, 0.00001238258, 0, 0, 0, 0, 0, 1, -360, 360],
            [114, 115, 0.000500801, 0.001179772, 0.00000186052, 0, 0, 0, 0, 0, 1, -360, 360],
            [112, 116, 0.001126803, 0.002654488, 0.00000418616, 0, 0, 0, 0, 0, 1, -360, 360],
            [116, 117, 0.002378806, 0.005603918, 0.00000883745, 0, 0, 0, 0, 0, 1, -360, 360],
            [117, 118, 0.002378806, 0.005603918, 0.00000883745, 0, 0, 0, 0, 0, 1, -360, 360],
            [117, 119, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
            [119, 120, 0.009819142, 0.009954328, 0.00000999833, 0, 0, 0, 0, 0, 1, -360, 360],
            [120, 121, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
            [120, 122, 0.006909766, 0.007004898, 0.00000703587, 0, 0, 0, 0, 0, 1, -360, 360],
            [122, 123, 0.002253606, 0.005308975, 0.00000837232, 0, 0, 0, 0, 0, 1, -360, 360],
            # 支路4
            [15, 54, 0.002545703, 0.002580752, 0.00000259216, 0, 0, 0, 0, 0, 1, -360, 360],
            [54, 55, 0.001377204, 0.003244374, 0.00000511642, 0, 0, 0, 0, 0, 1, -360, 360],
            [55, 56, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [56, 57, 0.001126803, 0.002654488, 0.00000418616, 0, 0, 0, 0, 0, 1, -360, 360],
            [57, 58, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            [58, 59, 0.001126803, 0.002654488, 0.00000418616, 0, 0, 0, 0, 0, 1, -360, 360],
            [59, 60, 0.004000391, 0.004055467, 0.00000407340, 0, 0, 0, 0, 0, 1, -360, 360],
            [60, 61, 0.001502404, 0.003539317, 0.00000558155, 0, 0, 0, 0, 0, 1, -360, 360],
            [61, 62, 0.002909375, 0.002949431, 0.00000296247, 0, 0, 0, 0, 0, 1, -360, 360],
            [62, 63, 0.001388941, 0.003205550, 0.00000486459, 0, 0, 0, 0, 0, 1, -360, 360],
            [54, 64, 0.002777882, 0.006411099, 0.00000972917, 0, 0, 0, 0, 0, 1, -360, 360],
            [64, 65, 0.001515208, 0.003496963, 0.00000530682, 0, 0, 0, 0, 0, 1, -360, 360],
            [65, 66, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [66, 67, 0.001388941, 0.003205550, 0.00000486459, 0, 0, 0, 0, 0, 1, -360, 360],
            [64, 68, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [68, 69, 0.010182813, 0.010323007, 0.00001036864, 0, 0, 0, 0, 0, 1, -360, 360],
            [69, 70, 0.003273047, 0.003318109, 0.00000333278, 0, 0, 0, 0, 0, 1, -360, 360],
            [70, 71, 0.001641476, 0.003788377, 0.00000574906, 0, 0, 0, 0, 0, 1, -360, 360],
            [71, 72, 0.008364454, 0.008479613, 0.00000851710, 0, 0, 0, 0, 0, 1, -360, 360],
            [72, 73, 0.006546094, 0.006636219, 0.00000666556, 0, 0, 0, 0, 0, 1, -360, 360],
            [73, 74, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            [74, 75, 0.008364454, 0.008479613, 0.00000851710, 0, 0, 0, 0, 0, 1, -360, 360],
            [74, 76, 0.001818360, 0.001843394, 0.00000185154, 0, 0, 0, 0, 0, 1, -360, 360],
            [76, 77, 0.007637110, 0.007742255, 0.00000777648, 0, 0, 0, 0, 0, 1, -360, 360],
            [77, 78, 0.004727735, 0.004792825, 0.00000481401, 0, 0, 0, 0, 0, 1, -360, 360],
            [78, 79, 0.001894011, 0.004371204, 0.00000663353, 0, 0, 0, 0, 0, 1, -360, 360],
            [79, 80, 0.002003205, 0.004719089, 0.00000744206, 0, 0, 0, 0, 0, 1, -360, 360],
            [79, 81, 0.002003205, 0.004719089, 0.00000744206, 0, 0, 0, 0, 0, 1, -360, 360],
            [81, 82, 0.001752804, 0.004129203, 0.00000651181, 0, 0, 0, 0, 0, 1, -360, 360],
            [81, 83, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            [83, 84, 0.001010139, 0.002331309, 0.00000353788, 0, 0, 0, 0, 0, 1, -360, 360],
            [83, 85, 0.001010139, 0.002331309, 0.00000353788, 0, 0, 0, 0, 0, 1, -360, 360],
            [85, 86, 0.001021302, 0.002294318, 0.00000392057, 0, 0, 0, 0, 0, 1, -360, 360],
            [85, 87, 0.001262674, 0.002914136, 0.00000442235, 0, 0, 0, 0, 0, 1, -360, 360],
            [87, 88, 0.004364063, 0.004424146, 0.00000444370, 0, 0, 0, 0, 0, 1, -360, 360],
            # 支路5
            [15, 16, 0.007273438, 0.007373577, 0.00000740617, 0, 0, 0, 0, 0, 1, -360, 360],
            [16, 17, 0.001001603, 0.002359545, 0.00000372103, 0, 0, 0, 0, 0, 1, -360, 360],
            [17, 18, 0.002909375, 0.002949431, 0.00000296247, 0, 0, 0, 0, 0, 1, -360, 360],
            [17, 19, 0.001252003, 0.002949431, 0.00000465129, 0, 0, 0, 0, 0, 1, -360, 360],
        ])

        ##-----  OPF Data  -----##
        ## generator cost data
        #	1	startup	shutdown	n	x1	y1	...	xn	yn
        #	2	startup	shutdown	n	c(n-1)	...	c0
        self.gencost = np.array([
            [2, 0, 0, 3, 0, 1, 0],
        ])


UL_nodes = [  8,  12,  25,  28,  36,  38, 42,  46,  50,  52,  54,  56,  58,  60,
64,  66,  68,  70,  72,  74,  76,  78,  80,  82,  84,  85,  88,
90,  92,  94,  96, 100, 102, 106, 110, 112, 114, 116, 118, 120,
122, 123]


DG_nodes = [5, 10,
            23, 32,
            37, 45, 51,
            89, 91, 98, 103 ,108, 117, 119,
            55, 57, 62, 65, 69, 71, 77, 84, 87
            ]  # 含分布式发电机的节点


mpc.bus_Vmin[1:]=0.85